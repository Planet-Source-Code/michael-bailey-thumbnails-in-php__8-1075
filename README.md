<div align="center">

## Thumbnails in PHP


</div>

### Description

Learn how to use the PHP GD extension to create thumbnails from your normal images on the fly.
 
### More Info
 


<span>             |<span>
---                |---
**Submitted On**   |
**By**             |[Michael Bailey](https://github.com/Planet-Source-Code/PSCIndex/blob/master/ByAuthor/michael-bailey.md)
**Level**          |Beginner
**User Rating**    |4.9 (44 globes from 9 users)
**Compatibility**  |PHP 4\.0
**Category**       |[Graphics/ Sound](https://github.com/Planet-Source-Code/PSCIndex/blob/master/ByCategory/graphics-sound__8-15.md)
**World**          |[PHP](https://github.com/Planet-Source-Code/PSCIndex/blob/master/ByWorld/php.md)
**Archive File**   |[](https://github.com/Planet-Source-Code/michael-bailey-thumbnails-in-php__8-1075/archive/master.zip)





### Source Code

<h2>Introduction</h2>
 <p>
 Depending upon how it's done, displaying a page of thumbnail images can be very cumbersome. Allowing the browser to resize images requires the client browser to download the entire, full-size image, then clumsily resize the image to a specified size. This causes the page to load very slowly and creates unavoidable distortion in the resulting images. The other option is to make separate thumbnail images for each individual image. This is fine if you only plan to display a few images, but becomes unrealistic on a large scale or a site involving dynamic images. Fortunately there are ways around these problems using the GD library in PHP.
 </p><p>
 This tutorial will outline how to write a PHP script to create thumbnail images on the fly. Since this requires the GD library, you will need an installation of PHP with at least GD 2.0.1 enabled (you can use older versions with a slight change which I will explain).
 </p><p>
 The script we will be writing receives one parameter on the query string which corresponds to the relative path of the full-size image. This address is to be placed as the src field of an image tag. An example image tag might look like this: <i>&lt;img src="/thumbnail.php?dir/image.png"&gt;</i>. With no further ado let us procede to the source code.
 </p>
 <h2>Source Code</h2>
 <p><table class=code><tr><td><code><font color="#000000"><font color="#FF9900"># Constants <br /></font><font color="#0000CC">define</font><font color="#006600">(</font><font color="#0000CC">IMAGE_BASE</font><font color="#006600">,&nbsp;</font><font color="#CC0000">'/var/www/html/mbailey/images'</font><font color="#006600">);<br /></font><font color="#0000CC">define</font><font color="#006600">(</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,&nbsp;</font><font color="#0000CC">150</font><font color="#006600">);<br /></font><font color="#0000CC">define</font><font color="#006600">(</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">,&nbsp;</font><font color="#0000CC">150</font><font color="#006600">);<br /><br /></font><font color="#FF9900"># Get image location <br /></font><font color="#0000CC">$image_file&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">str_replace</font><font color="#006600">(</font><font color="#CC0000">'..'</font><font color="#006600">,&nbsp;</font><font color="#CC0000">''</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$_SERVER</font><font color="#006600">[</font><font color="#CC0000">'QUERY_STRING'</font><font color="#006600">]);<br /></font><font color="#0000CC">$image_path&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">IMAGE_BASE&nbsp;</font><font color="#006600">.&nbsp;</font><font color="#CC0000">"/$image_file"</font><font color="#006600">;<br /><br /></font><font color="#FF9900"># Load image<br /></font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">null</font><font color="#006600">;<br /></font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">strtolower</font><font color="#006600">(</font><font color="#0000CC">end</font><font color="#006600">(</font><font color="#0000CC">explode</font><font color="#006600">(</font><font color="#CC0000">'.'</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$image_path</font><font color="#006600">)));<br />if&nbsp;(</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'jpg'&nbsp;</font><font color="#006600">||&nbsp;</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'jpeg'</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;@</font><font color="#0000CC">imagecreatefromjpeg</font><font color="#006600">(</font><font color="#0000CC">$image_path</font><font color="#006600">);<br />}&nbsp;else&nbsp;if&nbsp;(</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'png'</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;@</font><font color="#0000CC">imagecreatefrompng</font><font color="#006600">(</font><font color="#0000CC">$image_path</font><font color="#006600">);<br /></font><font color="#FF9900"># Only if your version of GD includes GIF support<br /></font><font color="#006600">}&nbsp;else&nbsp;if&nbsp;(</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'gif'</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;@</font><font color="#0000CC">imagecreatefrompng</font><font color="#006600">(</font><font color="#0000CC">$image_path</font><font color="#006600">);<br />}<br /><br /></font><font color="#FF9900"># If an image was successfully loaded, test the image for size<br /></font><font color="#006600">if&nbsp;(</font><font color="#0000CC">$img</font><font color="#006600">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># Get image size and scale ratio<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$width&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagesx</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$height&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagesy</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$scale&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">min</font><font color="#006600">(</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">/</font><font color="#0000CC">$width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">/</font><font color="#0000CC">$height</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># If the image is larger than the max shrink it<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#006600">if&nbsp;(</font><font color="#0000CC">$scale&nbsp;</font><font color="#006600">&lt;&nbsp;</font><font color="#0000CC">1</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$new_width&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">floor</font><font color="#006600">(</font><font color="#0000CC">$scale</font><font color="#006600">*</font><font color="#0000CC">$width</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$new_height&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">floor</font><font color="#006600">(</font><font color="#0000CC">$scale</font><font color="#006600">*</font><font color="#0000CC">$height</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># Create a new temporary image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tmp_img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagecreatetruecolor</font><font color="#006600">(</font><font color="#0000CC">$new_width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$new_height</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># Copy and resize old image into new image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imagecopyresized</font><font color="#006600">(</font><font color="#0000CC">$tmp_img</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$img</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$new_width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$new_height</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$height</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imagedestroy</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">$tmp_img</font><font color="#006600">;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;&nbsp;&nbsp;&nbsp;<br />}<br /><br /></font><font color="#FF9900"># Create error image if necessary<br /></font><font color="#006600">if&nbsp;(!</font><font color="#0000CC">$img</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagecreate</font><font color="#006600">(</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,&nbsp;</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imagecolorallocate</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$c&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagecolorallocate</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">70</font><font color="#006600">,</font><font color="#0000CC">70</font><font color="#006600">,</font><font color="#0000CC">70</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imageline</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">,</font><font color="#0000CC">$c2</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imageline</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">,</font><font color="#0000CC">$c2</font><font color="#006600">);<br />}<br /><br /></font><font color="#FF9900"># Display the image<br /></font><font color="#0000CC">header</font><font color="#006600">(</font><font color="#CC0000">"Content-type: image/jpeg"</font><font color="#006600">);<br /></font><font color="#0000CC">imagejpeg</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br /></font></font>
 </code></td></tr></table></p><h2>Explanation</h2>
 <p>We'll now proceed through the script and explain each block in excruciating detail. I hope you have caffeine ready, you may need it.</p>
 <p><table class=code><tr><td><code><font color="#000000"><font color="#FF9900"># Constants<br /></font><font color="#0000CC">define</font><font color="#006600">(</font><font color="#0000CC">IMAGE_BASE</font><font color="#006600">,&nbsp;</font><font color="#CC0000">'/var/www/html/mbailey/images'</font><font color="#006600">);<br /></font><font color="#0000CC">define</font><font color="#006600">(</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,&nbsp;</font><font color="#0000CC">150</font><font color="#006600">);<br /></font><font color="#0000CC">define</font><font color="#006600">(</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">,&nbsp;</font><font color="#0000CC">150</font><font color="#006600">);<br /></font></font>
 </code></td></tr></table></p><p>
 First we should define a few constants. <i>IMAGE_BASE</i> points to the directory from which images are to be served. Only images in or under this directory are available. <i>MAX_WIDTH</i> and <i>MAX_HEIGHT</i> specify the maximum size to which images will be shrunk. If an image is already smaller than these sizes, it is returned without modifications. Proportions are also retained so that if the width is reduced by a factor of 2, the height will be reduced by that same factor.
 </p>
 <p><table class=code><tr><td><code><font color="#000000"><font color="#FF9900"># Get image location<br /></font><font color="#0000CC">$image_file&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">str_replace</font><font color="#006600">(</font><font color="#CC0000">'..'</font><font color="#006600">,&nbsp;</font><font color="#CC0000">''</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$_SERVER</font><font color="#006600">[</font><font color="#CC0000">'QUERY_STRING'</font><font color="#006600">]);<br /></font><font color="#0000CC">$image_path&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">IMAGE_BASE&nbsp;</font><font color="#006600">.&nbsp;</font><font color="#CC0000">"/$image_file"</font><font color="#006600">;<br /><br /></font><font color="#FF9900"># Load image<br /></font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">null</font><font color="#006600">;<br /></font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">strtolower</font><font color="#006600">(</font><font color="#0000CC">end</font><font color="#006600">(</font><font color="#0000CC">explode</font><font color="#006600">(</font><font color="#CC0000">'.'</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$image_path</font><font color="#006600">)));<br />if&nbsp;(</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'jpg'&nbsp;</font><font color="#006600">||&nbsp;</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'jpeg'</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;@</font><font color="#0000CC">imagecreatefromjpeg</font><font color="#006600">(</font><font color="#0000CC">$image_path</font><font color="#006600">);<br />}&nbsp;else&nbsp;if&nbsp;(</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'png'</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;@</font><font color="#0000CC">imagecreatefrompng</font><font color="#006600">(</font><font color="#0000CC">$image_path</font><font color="#006600">);<br /></font><font color="#FF9900"># Only if your version of GD includes GIF support<br /></font><font color="#006600">}&nbsp;else&nbsp;if&nbsp;(</font><font color="#0000CC">$ext&nbsp;</font><font color="#006600">==&nbsp;</font><font color="#CC0000">'gif'</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;@</font><font color="#0000CC">imagecreatefrompng</font><font color="#006600">(</font><font color="#0000CC">$image_path</font><font color="#006600">);<br />}<br /></font></font>
 </code></td></tr></table></p><p>
 The image location is passed as the entire query string as explained above. To prevent people from accessing images outside of the specified path, the string replace function is used to remove any "..".
 </p><p>
 The extension is checked to find out what type of image has been requested. GD has a number of different load functions. Each is of the form <i>imageloadfrom[type]()</i>. I have included only the three most common image formats, though others can easily be added.
 </p><p>
 If the extension is unrecognized or the specified file does not exist, <i>$img</i> is left empty. When this occurs, an error is generated (see below). The <i>@</i> before the load functions suppresses errors so that the user won't be shown a page of garbage.
 </p><p>
 <b>NOTE:</b> <i>gif support isn't available in the newer versions of GD. If your version of GD does not support gif images, you should probably remove the lines for handling gif images.</i>
 </p>
 <p><table class=code><tr><td><code><font color="#000000"><font color="#FF9900"># If an image was successfully loaded, test the image for size<br /></font><font color="#006600">if&nbsp;(</font><font color="#0000CC">$img</font><font color="#006600">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># Get image size and scale ratio<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$width&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagesx</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$height&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagesy</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$scale&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">min</font><font color="#006600">(</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">/</font><font color="#0000CC">$width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">/</font><font color="#0000CC">$height</font><font color="#006600">);<br /></font></font>
 </code></td></tr></table></p><p>
 <i>imagesx()</i> and <i>imagesy()</i> return the width and height of the image respectively. The maximum size of the image is then divided by the actual size of the image. This results in a scaling ratio. This scaling ratio is multiplied by the actual image size in order to give the reduced size. This value is calculated for both the width and height seperately; though the smaller of the two is used. By using the same value for both width and height, we preserve the correct proportions.
 </p>
 <p><table class=code><tr><td><code><font color="#000000"&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># If the image is larger than the max shrink it<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#006600">if&nbsp;(</font><font color="#0000CC">$scale&nbsp;</font><font color="#006600">&lt;&nbsp;</font><font color="#0000CC">1</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$new_width&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">floor</font><font color="#006600">(</font><font color="#0000CC">$scale</font><font color="#006600">*</font><font color="#0000CC">$width</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$new_height&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">floor</font><font color="#006600">(</font><font color="#0000CC">$scale</font><font color="#006600">*</font><font color="#0000CC">$height</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># Create a new temporary image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$tmp_img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagecreatetruecolor</font><font color="#006600">(</font><font color="#0000CC">$new_width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$new_height</font><font color="#006600">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#FF9900"># Copy and resize old image into new image<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imagecopyresized</font><font color="#006600">(</font><font color="#0000CC">$tmp_img</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$img</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,&nbsp;</font><font color="#0000CC">0</font><font color="#006600">,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$new_width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$new_height</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$width</font><font color="#006600">,&nbsp;</font><font color="#0000CC">$height</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imagedestroy</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">$tmp_img</font><font color="#006600">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />}<br /></font></font>
 </code></td></tr></table></p><p>
 If the scale ratio is greater than or equal to 1 the image does not need to be modified in any way. Otherwise, the image must be reduced in size by that value. The new image size is generated by multiplying the scale by the current size.
 </p><p>
 Using these new dimensions a buffer image is created using <i>imagecreatetruecolor()</i>. If you are using a GD library prior to 2.0, you will need to change this function to <i>imagecreate()</i>. The true color version of this function was added in 2.0 to preserve color integrity when parts of an image are copied, which we are about to do. The older function will still work fine for many images, but high color photos and the like may not maintain the correct colors using the older function.
 </p><p>
 The original image is then resized into the buffer image. Since we will now be using this new image, we are able to free the original image with <i>imagedestroy()</i>. The buffer image is then renamed to <i>$img</i>.
 </p>
 <p><table class=code><tr><td><code><font color="#000000"><font color="#FF9900"># Create error image if necessary<br /></font><font color="#006600">if&nbsp;(!</font><font color="#0000CC">$img</font><font color="#006600">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$img&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagecreate</font><font color="#006600">(</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,&nbsp;</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imagecolorallocate</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">$c&nbsp;</font><font color="#006600">=&nbsp;</font><font color="#0000CC">imagecolorallocate</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">70</font><font color="#006600">,</font><font color="#0000CC">70</font><font color="#006600">,</font><font color="#0000CC">70</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imageline</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">,</font><font color="#0000CC">$c2</font><font color="#006600">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#0000CC">imageline</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">,</font><font color="#0000CC">MAX_WIDTH</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">0</font><font color="#006600">,</font><font color="#0000CC">MAX_HEIGHT</font><font color="#006600">,</font><font color="#0000CC">$c2</font><font color="#006600">);<br />}<br /></font></font>
 </code></td></tr></table></p><p>
 As was explained earlier, if the image's extension was unrecognizable, or the file did not exist all together, <i>$img</i> was left empty. If this is the case, we need to generate a place holder image to notify the user that the image they requested was unavailable. We do this by drawing a black box with a gray X through the middle. You may want to make this more explicit, by adding text or even redirecting the browser to a premade image.
 </p>
 <p><table class=code><tr><td><code><font color="#000000"><font color="#FF9900"># Display the image<br /></font><font color="#0000CC">header</font><font color="#006600">(</font><font color="#CC0000">"Content-type: image/jpeg"</font><font color="#006600">);<br /></font><font color="#0000CC">imagejpeg</font><font color="#006600">(</font><font color="#0000CC">$img</font><font color="#006600">);<br /></font></font>
 </code></td></tr></table></p><p>The image is finally displayed to the user in jpeg format.</p>
 <h2>Conclusion</h2>
 <p>
 As you can see, adding on-the-fly generated thumbnails to your website is quite easy to accomplish with GD and PHP. Now if you're anything like me, all you need to do is find something worth displaying on your website. That's the part I can't help you with, sorry.
 </p>
 <br>

